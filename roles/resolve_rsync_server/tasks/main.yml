---
- name: Prepare device list
  set_fact:
    devices: "{{ devices|default([]) + [ {'device': item, 'time': '10000', 'device_var': item | replace('-', '_'), 'host_var': inventory_hostname | replace('-', '_') } ] }}"
  loop: "{{groups['devices']}}"

- name: Ping devices tasks
  include_tasks: ping.yml
  vars: 
    device: "{{item}}"
    device_var: "{{item | replace('-', '_')}}"
    host_var: "{{inventory_hostname | replace('-', '_')}}"
  loop: "{{groups['devices']}}"

# - debug: var="devices"
