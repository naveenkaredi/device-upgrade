---
- name: Fetch volume names
  include_role:
    name: utils/prepare_prechecks_content
  
- name: View file contents
  shell: "cat prechecks/{{file_name}}"
  register: cat_output
- debug: var=cat_output

- name: Creates postchecks directory
  file:
    path: "postchecks"
    state: directory
  run_once: true

- name: Check directory stats
  stat:
    path: "postchecks"
  register: dir

- name: Setting fact for device variable
  set_fact:  
    postchecks_file_name="postchecks_{{ inventory_hostname }}"

- name: Remove existing file if it exists
  file:
    path: "postchecks/{{postchecks_file_name}}.txt"
    state: absent
  when: dir.stat.exists and dir.stat.isdir

- name: Creates file
  file:
    path: "postchecks/{{postchecks_file_name}}.txt"
    state: touch
  when: dir.stat.exists and dir.stat.isdir
  register: file_path

- name: IOS run commands and capture
  include_role:
    name: utils/command_capture
  vars:
    command: "{{ item.cmd }}"
    device_type: ios
    folder_type: postchecks
  loop: "{{ check_commands.ios }}"

